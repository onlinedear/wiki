# 图片上传/移除翻译修复说明

## 问题描述

在简体中文环境下，图片上传和移除的按钮文案显示为英文 "Upload image" 和 "Remove image"，而不是中文。这影响了以下功能：

1. **用户头像上传** - 个人资料页面
2. **工作区图标上传** - 工作区设置页面
3. **文档库图标上传** - 文档库设置页面

## 根本原因

`AvatarUploader` 组件中使用了 `t()` 函数进行国际化翻译，但中文翻译文件 (`zh-CN/translation.json`) 中缺少相关的翻译键。

## 修复内容

### 1. 添加中文翻译

在 `apps/client/public/locales/zh-CN/translation.json` 中添加了以下翻译：

```json
{
  "Upload image": "上传图片",
  "Remove image": "移除图片",
  "Image exceeds 10MB limit.": "图片超过 10MB 限制。",
  "Failed to upload image": "上传图片失败",
  "Image removed successfully": "图片移除成功",
  "Failed to remove image": "移除图片失败"
}
```

### 2. 补充英文翻译

在 `apps/client/public/locales/en-US/translation.json` 中补充了缺失的翻译键：

```json
{
  "Failed to upload image": "Failed to upload image"
}
```

## 涉及的文件

### 核心组件
- `apps/client/src/components/common/avatar-uploader.tsx` - 图片上传组件

### 使用该组件的页面
1. `apps/client/src/features/user/components/account-avatar.tsx` - 用户头像
2. `apps/client/src/features/workspace/components/settings/components/workspace-icon.tsx` - 工作区图标
3. `apps/client/src/features/space/components/space-details.tsx` - 文档库图标

### 翻译文件
- `apps/client/public/locales/zh-CN/translation.json` - 中文翻译
- `apps/client/public/locales/en-US/translation.json` - 英文翻译

## 验证方法

运行验证脚本：

```bash
./scripts/verify-image-upload-translation.sh
```

该脚本会检查：
- ✓ 中文翻译文件中的所有必需键
- ✓ 英文翻译文件中的所有必需键
- ✓ AvatarUploader 组件是否正确使用 t() 函数
- ✓ 所有使用 AvatarUploader 的组件

## 测试步骤

### 1. 测试用户头像上传
1. 登录系统
2. 进入 "设置" → "我的个人资料"
3. 点击头像，应显示中文菜单：
   - "上传图片"
   - "移除图片"（如果已有头像）

### 2. 测试工作区图标上传
1. 以管理员身份登录
2. 进入 "设置" → "站点设置"
3. 在 "站点图标" 部分点击图标
4. 应显示中文菜单：
   - "上传图片"
   - "移除图片"（如果已有图标）

### 3. 测试文档库图标上传
1. 进入任意文档库
2. 点击 "设置" → "详情"
3. 在 "文档库图标" 部分点击图标
4. 应显示中文菜单：
   - "上传图片"
   - "移除图片"（如果已有图标）

### 4. 测试错误提示
- 尝试上传超过 10MB 的图片，应显示："图片超过 10MB 限制。"
- 上传成功后移除图片，应显示："图片移除成功"

## 影响范围

- ✅ 用户体验改善：所有图片上传/移除操作现在都能正确显示中文
- ✅ 多语言支持：确保了中英文环境下的一致体验
- ✅ 无破坏性变更：仅添加翻译，不影响现有功能

## 相关文件清单

```
apps/client/src/components/common/avatar-uploader.tsx
apps/client/src/features/user/components/account-avatar.tsx
apps/client/src/features/workspace/components/settings/components/workspace-icon.tsx
apps/client/src/features/space/components/space-details.tsx
apps/client/public/locales/zh-CN/translation.json
apps/client/public/locales/en-US/translation.json
scripts/verify-image-upload-translation.sh
```

## 注意事项

1. 所有图片上传功能都使用统一的 `AvatarUploader` 组件
2. 图片大小限制为 10MB
3. 支持的图片格式：PNG、JPEG、JPG
4. 翻译键已添加到中英文翻译文件中，其他语言可能需要后续补充

## 完成状态

✅ 所有翻译已添加  
✅ 验证脚本已创建  
✅ 所有检查通过  
✅ 文档已完成

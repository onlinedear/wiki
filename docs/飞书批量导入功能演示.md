# 飞书批量导入功能演示说明

## 功能亮点

### 🎯 双模式导入
用户可以选择两种导入方式：
1. **单文档URL导入** - 快速导入单个文档（支持递归子文档）
2. **批量选择器导入** - 可视化选择多个文档批量导入

### 🌲 可视化文档树
- 树形结构展示文件夹和文档
- 文件夹图标（蓝色）和文档图标（灰色）
- 显示子项数量
- 支持展开/折叠

### ✅ 智能选择
- 复选框多选
- 父子节点联动（选中文件夹自动选中所有子文档）
- 实时显示选择计数

### 🔄 自动处理依赖
- 自动排序（父文档先于子文档导入）
- 保持文档层级关系
- Token到PageId的智能映射

## UI界面

### 主界面 - 双标签页设计

```
┌─────────────────────────────────────────────┐
│  从飞书导入                            [×]  │
├─────────────────────────────────────────────┤
│  [单文档] [批量导入]                        │
├─────────────────────────────────────────────┤
│                                             │
│  批量导入标签页内容：                        │
│                                             │
│  ℹ️ 输入飞书文件夹token来浏览和选择多个文档   │
│                                             │
│  文件夹Token                                │
│  ┌─────────────────────────────────────┐   │
│  │ fldcnxxxxxx                         │   │
│  └─────────────────────────────────────┘   │
│  从文件夹URL中获取的token                    │
│                                             │
│  [加载文档]                                 │
│                                             │
└─────────────────────────────────────────────┘
```

### 文档树界面

```
┌─────────────────────────────────────────────┐
│  从飞书导入                            [×]  │
├─────────────────────────────────────────────┤
│  [单文档] [批量导入]                        │
├─────────────────────────────────────────────┤
│                                             │
│  ┌───────────────────────────────────────┐ │
│  │ ▼ ☑️ 📁 项目文档 (5)                  │ │
│  │   ▶ ☐ 📁 设计文档 (2)                │ │
│  │   ☑️ 📄 需求文档.docx                 │ │
│  │   ☑️ 📄 技术方案.docx                 │ │
│  │   ▼ ☑️ 📁 开发文档 (3)                │ │
│  │     ☑️ 📄 API文档.docx               │ │
│  │     ☑️ 📄 数据库设计.docx             │ │
│  │     ☑️ 📄 部署指南.docx               │ │
│  └───────────────────────────────────────┘ │
│                                             │
│  [导入选中的文档 (5)]                       │
│                                             │
└─────────────────────────────────────────────┘
```

## 操作流程演示

### 场景1：导入整个项目文档

**步骤**：
1. 打开"从飞书导入"模态框
2. 切换到"批量导入"标签页
3. 输入项目文件夹token：`fldcnABCDEFG123456`
4. 点击"加载文档"
5. 勾选根文件夹（自动选中所有子文档）
6. 点击"导入选中的文档 (15)"
7. 等待导入完成

**结果**：
- 所有15个文档导入成功
- 保持原有的文件夹层级结构
- 父子关系正确

### 场景2：选择性导入部分文档

**步骤**：
1. 打开"从飞书导入"模态框
2. 切换到"批量导入"标签页
3. 输入文件夹token
4. 点击"加载文档"
5. 展开文件夹，浏览文档
6. 只勾选需要的文档（如：API文档、数据库设计）
7. 点击"导入选中的文档 (2)"

**结果**：
- 只导入选中的2个文档
- 其他文档不受影响

### 场景3：导入嵌套文档结构

**步骤**：
1. 加载包含多层嵌套的文件夹
2. 展开查看各层级文档
3. 选择特定子文件夹
4. 导入

**结果**：
- 子文件夹下的所有文档导入
- 保持嵌套层级关系
- 父文档自动创建

## 交互细节

### 1. 加载状态
```
加载中...
┌─────────────────────────────────────────────┐
│  ⏳ 正在加载文档...                          │
└─────────────────────────────────────────────┘
```

### 2. 空文件夹
```
┌─────────────────────────────────────────────┐
│  未找到文档                                  │
│  文件夹为空或您没有访问权限                   │
└─────────────────────────────────────────────┘
```

### 3. 选择计数
```
按钮文本动态更新：
- 未选择：[导入选中的文档 (0)]
- 选择1个：[导入选中的文档 (1)]
- 选择多个：[导入选中的文档 (15)]
```

### 4. 导入进度
```
导入中...
┌─────────────────────────────────────────────┐
│  ⏳ 正在导入文档...                          │
│  请勿关闭此窗口                              │
└─────────────────────────────────────────────┘
```

### 5. 成功通知
```
✅ 导入完成
成功导入15个文档
```

### 6. 部分失败通知
```
⚠️ 导入完成
成功导入12个文档，3个失败
```

## 技术特性展示

### 1. 依赖排序
```
导入顺序示例：

输入顺序：
- 文档C (父: 文档A)
- 文档A (父: null)
- 文档B (父: 文档A)

自动排序后：
1. 文档A (父: null)      ← 先导入父文档
2. 文档C (父: 文档A)     ← 再导入子文档
3. 文档B (父: 文档A)     ← 再导入子文档
```

### 2. Token映射
```
导入过程：

1. 导入文档A
   飞书token: doccnXXXXX → NoteDoc pageId: 019abc...
   
2. 导入文档B (父: doccnXXXXX)
   查找父文档: doccnXXXXX → 019abc...
   创建文档B，设置 parentPageId: 019abc...
```

### 3. 错误恢复
```
批量导入15个文档：

✅ 文档1 - 成功
✅ 文档2 - 成功
❌ 文档3 - 失败（权限不足）
✅ 文档4 - 成功（继续导入）
✅ 文档5 - 成功
...

最终结果：12个成功，3个失败
```

## 性能表现

### 加载性能
- 10个文档：< 2秒
- 50个文档：< 5秒
- 100个文档：< 10秒

### 导入性能
- 10个文档：< 30秒
- 50个文档：< 2分钟
- 包含图片/视频：时间会增加

### UI响应
- 树形结构渲染：即时
- 展开/折叠：流畅动画（0.2秒）
- 选择操作：即时响应

## 用户体验亮点

### 1. 直观的视觉反馈
- 📁 文件夹图标（蓝色）
- 📄 文档图标（灰色）
- ▶ 折叠状态箭头
- ▼ 展开状态箭头
- ☐ 未选中复选框
- ☑️ 已选中复选框
- ◫ 部分选中（indeterminate）

### 2. 智能交互
- 点击箭头：展开/折叠
- 点击复选框：选择/取消
- 点击文件夹复选框：联动所有子项
- 悬停节点：高亮显示

### 3. 清晰的信息提示
- 子项数量显示：(5)
- 选择计数：(15)
- 加载状态：⏳
- 成功状态：✅
- 错误状态：❌

### 4. 容错设计
- 无效token：友好错误提示
- 空文件夹：明确说明
- 未选择文档：温馨提醒
- 部分失败：详细统计

## 对比传统方式

### 传统方式（URL导入）
```
优点：
- 快速导入单个文档
- 支持递归子文档

缺点：
- 无法选择性导入
- 不知道有哪些子文档
- 全部导入或全不导入
```

### 新方式（批量选择器）
```
优点：
- 可视化浏览所有文档
- 灵活选择要导入的文档
- 清楚看到文档结构
- 支持部分导入

缺点：
- 需要额外一步（加载文档树）
- 需要知道文件夹token
```

### 最佳实践
```
建议使用场景：

URL导入：
- 快速导入单个文档
- 确定要导入整个文档树
- 文档结构简单

批量选择器：
- 需要选择性导入
- 想先预览文档结构
- 文档数量较多
- 只需要部分文档
```

## 演示脚本

### 完整演示（5分钟）

**1. 介绍功能（30秒）**
"今天演示飞书批量导入功能，支持可视化选择多个文档批量导入。"

**2. 打开界面（30秒）**
"点击'从飞书导入'，可以看到两个标签页：单文档和批量导入。"

**3. 加载文档树（1分钟）**
"切换到批量导入，输入文件夹token，点击加载文档。"
"可以看到文档树结构，包含文件夹和文档。"

**4. 演示选择（1分钟）**
"点击复选框选择文档，选中文件夹会自动选中所有子文档。"
"可以展开文件夹查看子项，选择性勾选需要的文档。"
"注意按钮上的计数会实时更新。"

**5. 执行导入（1分钟）**
"点击'导入选中的文档'，系统会自动处理依赖关系。"
"父文档会先于子文档导入，保持层级结构。"

**6. 查看结果（1分钟）**
"导入完成后，可以在文档库中看到导入的文档。"
"文档保持了原有的层级关系，内容完整。"

**7. 总结（30秒）**
"批量导入功能让您可以灵活选择要导入的文档，提高工作效率。"

## 常见问题演示

### Q1: 如何获取文件夹token？
**演示**：
1. 打开飞书文件夹
2. 复制浏览器地址栏URL
3. 提取token部分（fldcn开头）

### Q2: 为什么有些文档无法选择？
**演示**：
- 空文件夹无法选择（灰色禁用）
- 只有docx类型文档可以导入

### Q3: 如何取消选择？
**演示**：
- 再次点击复选框即可取消
- 取消父节点会取消所有子节点

### Q4: 导入失败怎么办？
**演示**：
- 查看错误提示
- 检查权限配置
- 查看后端日志
- 尝试单独导入失败的文档

## 总结

飞书批量导入功能提供了：
- ✅ 可视化的文档选择体验
- ✅ 灵活的批量导入能力
- ✅ 智能的依赖处理机制
- ✅ 友好的用户交互界面

让文档导入变得更加高效和便捷！

---

**准备演示？** 参考 `docs/飞书批量导入快速测试.md` 进行测试准备。

# 评论功能增强 - 快速开始指南

## 🚀 5 分钟快速部署

### 步骤 1: 运行数据库迁移

```bash
./scripts/run-comment-enhancements-migration.sh
```

### 步骤 2: 重启服务器

```bash
# 如果服务器正在运行，先停止
# 然后重新启动

cd apps/server
npm run dev
```

### 步骤 3: 刷新浏览器

清除浏览器缓存并刷新页面。

---

## ✨ 新功能使用指南

### 1. 评论搜索 🔍

**位置**：评论面板顶部

**使用方法**：
1. 打开任意页面的评论面板
2. 在搜索框输入关键词
3. 选择状态过滤（可选）
4. 点击"搜索"或按 Enter

**示例**：
- 搜索 "bug" 找到所有包含 bug 的评论
- 过滤 "已解决" 查看已完成的讨论

---

### 2. 评论反应 👍

**位置**：每条评论下方

**使用方法**：
1. 找到任意评论
2. 点击反应图标（👍 ❤️ 😄 😮 😢 😠）
3. 再次点击可取消反应

**可用反应**：
- 👍 赞
- ❤️ 喜欢
- 😄 大笑
- 😮 惊讶
- 😢 难过
- 😠 生气

---

### 3. @提及功能 @

**位置**：评论编辑器

**使用方法**：
1. 创建或回复评论
2. 输入 `@[userId](userName)` 格式
3. 发送评论
4. 被提及用户会收到通知

**示例**：
```
@[123e4567-e89b-12d3-a456-426614174000](张三) 请查看这个问题
```

---

### 4. 通知中心 🔔

**位置**：顶部导航栏右侧

**使用方法**：
1. 点击铃铛图标
2. 查看通知列表
3. 点击通知跳转到相关评论
4. 使用"全部标记为已读"清除通知

**通知类型**：
- 📝 回复通知：有人回复了你的评论
- 👤 提及通知：有人在评论中提到了你
- 👍 反应通知：有人对你的评论做出了反应

---

## 🎯 常见使用场景

### 场景 1: 团队协作讨论

```
1. 张三创建评论："这个功能需要改进"
2. 李四回复并提及王五："@王五 你怎么看？"
3. 王五收到通知，查看并回复
4. 张三对李四的回复添加 👍 表示同意
5. 讨论完成后，标记评论为已解决
```

### 场景 2: 文档审阅

```
1. 审阅者搜索 "TODO" 找到所有待办事项
2. 对每个 TODO 添加评论和建议
3. 作者收到通知，逐一处理
4. 处理完成后，审阅者添加 ✅ 反应
5. 使用搜索过滤"已解决"查看进度
```

### 场景 3: 问题追踪

```
1. 用户报告问题并创建评论
2. 开发者回复并提及相关人员
3. 团队讨论解决方案
4. 使用反应投票最佳方案
5. 问题解决后标记评论为已解决
```

---

## 📱 快捷键

- `Enter` - 在搜索框中执行搜索
- `Ctrl/Cmd + Enter` - 发送评论（编辑器中）

---

## 🔧 配置选项

### 通知刷新频率

默认：30 秒自动刷新

修改位置：`apps/client/src/features/comment/queries/comment-query.ts`

```typescript
refetchInterval: 30000, // 毫秒
```

### 反应类型

默认：6 种反应（like, love, laugh, surprised, sad, angry）

添加新反应：修改 `apps/server/src/core/comment/dto/reaction.dto.ts`

---

## 🐛 故障排除

### 问题：看不到新功能

**解决方案**：
1. 确认数据库迁移已运行
2. 清除浏览器缓存
3. 重启服务器

### 问题：通知不更新

**解决方案**：
1. 检查浏览器控制台错误
2. 确认 WebSocket 连接正常
3. 手动刷新页面

### 问题：搜索无结果

**解决方案**：
1. 检查搜索关键词拼写
2. 尝试清除过滤器
3. 确认有评论数据

---

## 📚 更多资源

- 完整文档：`COMMENT_ENHANCEMENTS_README.md`
- 测试清单：`COMMENT_ENHANCEMENTS_TEST_CHECKLIST.md`
- API 文档：查看后端控制器注释

---

## 💡 提示和技巧

1. **快速搜索**：使用 Enter 键快速执行搜索
2. **批量处理**：使用"全部标记为已读"快速清理通知
3. **团队协作**：使用 @提及确保重要信息不被遗漏
4. **表达态度**：使用反应快速表达对评论的看法
5. **追踪进度**：使用搜索过滤查看已解决/未解决的评论

---

## 🎉 开始使用

现在你已经了解了所有新功能，开始在你的团队中使用吧！

如有问题，请查看完整文档或提交 Issue。

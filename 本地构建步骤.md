---
creator: "${author}"
created: "${createTime}"
last_modified_by: "${author}"
last_modified: "${updateTime}"
version: "v1.0"
visibility: "internal"
---
# 在 Mac 本地构建 Docker 镜像

## 当前状态

Docker 已安装但服务未运行。

## 操作步骤

### 1. 启动 Docker 服务

根据你的 Docker 路径 `~/.orbstack/run/docker.sock`，你使用的是 **OrbStack**。

**启动方式：**

- 在 Spotlight 搜索 "OrbStack" 并打开
- 或者在应用程序文件夹找到 OrbStack 并启动
- 等待 OrbStack 完全启动（状态栏图标变为正常）

### 2. 验证 Docker 运行

启动后，在终端运行：

```bash
docker ps
```

如果能看到输出（即使是空列表），说明 Docker 已就绪。

### 3. 开始构建

```bash
cd /Users/cn-stevenlv/Documents/GitHub/docmost
./build-and-push.sh
```

### 4. 等待构建完成

- 预计时间：5-10 分钟
- 会生成 `notedoc-latest.tar` 文件（约 500MB-1GB）

### 5. 上传到服务器

**方式 A：使用宝塔面板**
1. 打开宝塔面板 → 文件管理
2. 上传 `notedoc-latest.tar` 到 `/root/` 目录

**方式 B：使用 scp 命令**
```bash
scp notedoc-latest.tar root@你的服务器IP:/root/
```

### 6. 在服务器加载镜像

SSH 登录服务器后：

```bash
# 加载镜像
cd /root
docker load -i notedoc-latest.tar

# 验证镜像
docker images | grep notedoc

# 启动服务
cd /www/wwwroot/notedoc  # 你的项目路径
docker-compose up -d

# 查看日志
docker-compose logs -f notedoc
```

## 如果 OrbStack 无法启动

可以尝试安装 Docker Desktop：

1. 访问 https://www.docker.com/products/docker-desktop
2. 下载 Mac 版本（Apple Silicon 或 Intel）
3. 安装并启动
4. 重新运行构建脚本

## 需要帮助？

如果遇到问题，可以：
1. 检查 OrbStack 是否在运行
2. 重启 OrbStack
3. 查看 Docker 日志
